# UX Specification: F005-US003
## Version: 2.0

## Overview
Provide market context for strategy performance and benchmark comparisons, helping users understand how their strategies perform relative to market conditions and relevant indices.

## User Flow (Happy Path)
1. Entry: User navigates to strategy performance page from portfolio dashboard
2. Context Loading: System displays strategy performance with market context and benchmark comparisons
3. Analysis: User reviews performance metrics adjusted for market regime and volatility conditions
4. Comparison: User examines strategy behavior across different market cycles
5. Completion: User gains clear understanding of strategy performance in market context

## Screen Specifications

### Screen: Strategy Performance Context
**Purpose**: Display strategy performance with comprehensive market context and benchmark analysis

**Layout**:
- USES: page_header from P40-10
- USES: data_card from P40-10
- USES: performance_chart from P40-10
- USES: metric_display from P40-10
- Grid: Responsive 3-column layout on desktop, stacked on mobile

**Design Tokens**:
```yaml
layout:
  container_padding: "spacing.semantic.2xl"
  section_gap: "spacing.semantic.xl"
  card_gap: "spacing.semantic.lg"
  
colors:
  background: "colors.semantic.background"
  section_divider: "colors.semantic.border.subtle"
  
typography:
  section_heading: "typography.semantic.h4"
  context_text: "typography.semantic.body"
  
effects:
  section_shadow: "effects.shadows.sm"
```

**Component Customization**:
```yaml
page_header:
  overrides:
    title: "Strategy Performance Context"
    subtitle: "Market-adjusted performance analysis"

performance_chart:
  overrides:
    height: 400
    showGrid: true
    interactive: true
    
data_card:
  overrides:
    hoverable: false
```

**Interactions**:
- Click benchmark selector: Switch between S&P 500, sector indices, volatility index
- Hover chart data points: Show market regime context tooltip
- Click market cycle tabs: Filter performance by bull/bear/sideways markets

**Responsive Behavior**:
- Mobile (<768px): Single column, charts stack vertically, `spacing.semantic.md`
- Desktop (>768px): 3-column grid for metrics, 2-column for charts, `spacing.semantic.xl`

### Screen: Market Regime Analysis
**Purpose**: Show strategy performance breakdown by different market conditions

**Layout**:
- USES: data_table from P40-10
- USES: status_badge from P40-10
- USES: metric_display from P40-10
- Grid: Full-width table with metric cards above

**Design Tokens**:
```yaml
layout:
  table_container_padding: "spacing.semantic.lg"
  metrics_grid_gap: "spacing.semantic.md"
  
colors:
  regime_bull: "colors.semantic.profit"
  regime_bear: "colors.semantic.loss"
  regime_sideways: "colors.semantic.neutral"
  performance_highlight: "colors.semantic.primary_light"
  
typography:
  regime_label: "typography.semantic.body"
  performance_value: "typography.semantic.price"
```

**Component Customization**:
```yaml
data_table:
  overrides:
    sortable: true
    columns: ["Market Regime", "Duration", "Strategy Return", "Benchmark Return", "Relative Performance"]
    
status_badge:
  overrides:
    size: "sm"
    
metric_display:
  overrides:
    format: "percentage"
```

**Interactions**:
- Click regime row: Drill down into specific market period details
- Sort table columns: Reorder by performance metrics
- Toggle relative/absolute view: Switch between raw and benchmark-adjusted returns

**Responsive Behavior**:
- Mobile (<768px): Table scrolls horizontally, metrics stack vertically
- Desktop (>768px): Full table display, metrics in 4-column grid

### Screen: Benchmark Comparison Dashboard
**Purpose**: Compare strategy against multiple relevant benchmarks and indices

**Layout**:
- USES: grid_layout from P40-10
- USES: performance_chart from P40-10
- USES: data_card from P40-10
- Grid: 2x2 chart grid with benchmark selector sidebar

**Design Tokens**:
```yaml
layout:
  chart_grid_gap: "spacing.semantic.lg"
  sidebar_width: "spacing.scale.64"
  content_padding: "spacing.semantic.xl"
  
colors:
  strategy_line: "colors.semantic.primary"
  benchmark_line: "colors.semantic.text.secondary"
  outperformance_area: "colors.semantic.profit"
  underperformance_area: "colors.semantic.loss"
  
typography:
  benchmark_label: "typography.semantic.body_sm"
  performance_delta: "typography.semantic.price"
```

**Component Customization**:
```yaml
performance_chart:
  overrides:
    type: "line"
    height: 300
    showGrid: true
    
grid_layout:
  overrides:
    columns: 2
    gap: "spacing.semantic.lg"
```

**Interactions**:
- Select benchmarks: Add/remove comparison indices from sidebar
- Hover chart intersection: Show performance delta at specific dates
- Click performance period: Zoom into specific time range

**Responsive Behavior**:
- Mobile (<768px): Charts stack vertically, sidebar becomes top selector
- Desktop (>768px): 2x2 grid layout with fixed sidebar

## State Management
**States with Token References**:
```yaml
loading_context:
  spinner_color: "colors.semantic.primary"
  overlay_background: "colors.semantic.surface"
  
performance_positive:
  highlight_color: "colors.semantic.profit"
  background_tint: "colors.financial.chart_colors.profit_area"
  
performance_negative:
  highlight_color: "colors.semantic.loss"
  background_tint: "colors.financial.chart_colors.loss_area"
  
market_regime_bull:
  indicator_color: "colors.semantic.profit"
  background: "colors.semantic.background"
  
market_regime_bear:
  indicator_color: "colors.semantic.loss"
  background: "colors.semantic.background"
  
market_regime_sideways:
  indicator_color: "colors.semantic.neutral"
  background: "colors.semantic.background"
```

## Shared Components Usage Summary
- page_header: All screens
- performance_chart: 3 instances
- data_card: 4 instances
- metric_display: 6 instances
- data_table: 1 instance
- grid_layout: 2 instances
- status_badge: 1 instance

## Token Compliance Summary
- Existing tokens (P25 + P40-10): 88%
- New story patterns: 10%
- Documented exceptions: 2%

## Market Context Integration
**Data Sources**:
- Market indices: S&P 500, sector ETFs, VIX
- Economic indicators: Interest rates, inflation data
- Market regime classification: Bull/bear/sideways periods

**Performance Adjustments**:
- Risk-adjusted returns using market volatility
- Sector-relative performance for equity strategies
- Currency-adjusted returns for FX strategies

**Benchmark Selection Logic**:
- Equity strategies: Compare to relevant sector indices
- FX strategies: Compare to currency carry indices
- Multi-asset strategies: Compare to balanced portfolio benchmarks
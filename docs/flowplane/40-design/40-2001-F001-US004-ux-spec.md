# UX Specification: F001-US004
## Version: 2.0

## Overview
Enable users to analyze correlation between discovered strategies to ensure portfolio diversification and make informed decisions about strategy selection based on correlation thresholds.

## User Flow (Happy Path)
1. Entry: User navigates to Strategy Discovery â†’ Correlation Analysis from main navigation
2. Interaction: System displays correlation matrix of active strategies with color-coded correlation values
3. Analysis: User reviews correlation patterns and identifies highly correlated strategy pairs
4. Decision: User can filter strategies by correlation threshold and view diversification recommendations
5. Completion: User understands portfolio correlation risk and can make informed strategy selection decisions

## Screen Specifications

### Screen: Correlation Analysis Dashboard
**Purpose**: Display comprehensive correlation analysis between all active strategies with visual indicators and filtering capabilities

**Layout**:
- USES: main_navigation from P40-10
- USES: page_header from P40-10
- USES: correlation_matrix from P40-10
- USES: data_card from P40-10
- USES: metric_display from P40-10
- Grid: Two-column layout with correlation matrix (left) and analysis panel (right)

**Design Tokens**:
```yaml
layout:
  container_padding: "spacing.semantic.2xl"
  content_gap: "spacing.semantic.lg"
  grid_columns: "2fr 1fr"
  
colors:
  background: "colors.semantic.background"
  surface: "colors.semantic.surface_elevated"
  text_primary: "colors.semantic.text.primary"
  text_secondary: "colors.semantic.text.secondary"
  
typography:
  page_title: "typography.semantic.h2"
  section_title: "typography.semantic.h4"
  body_text: "typography.semantic.body"
  
effects:
  card_shadow: "effects.semantic.card"
  transition: "effects.semantic_transitions.hover"
```

**Component Customization**:
```yaml
page_header:
  overrides:
    title: "Strategy Correlation Analysis"
    subtitle: "Monitor portfolio diversification and correlation risk"

correlation_matrix:
  overrides:
    showValues: true
    interactive: true
    size: "large"

data_card:
  overrides:
    hoverable: false
    padding: "spacing.semantic.xl"
```

**Interactions**:
- Click matrix cell: Highlight strategy pair details with `effects.semantic_transitions.hover`
- Hover correlation value: Show tooltip with exact correlation and time period
- Filter threshold slider: Update matrix display with `effects.semantic_transitions.normal`

**Responsive Behavior**:
- Mobile (<768px): Stack vertically, correlation matrix scrollable horizontally
- Desktop (>768px): Two-column grid layout with fixed matrix size

### Screen: Strategy Pair Detail View
**Purpose**: Show detailed correlation analysis for a specific strategy pair when matrix cell is clicked

**Layout**:
- USES: modal from P40-10
- USES: performance_chart from P40-10
- USES: metric_display from P40-10
- USES: button from P40-10

**Design Tokens**:
```yaml
layout:
  modal_width: "spacing.scale.128"
  content_gap: "spacing.semantic.lg"
  
colors:
  modal_background: "colors.semantic.surface_elevated"
  chart_background: "colors.semantic.background"
  
typography:
  modal_title: "typography.semantic.h3"
  metric_label: "typography.semantic.body_sm"
  
spacing:
  modal_padding: "spacing.semantic.2xl"
  chart_height: "300px"
```

**Component Customization**:
```yaml
modal:
  overrides:
    size: "lg"
    title: "Strategy Correlation Details"

performance_chart:
  overrides:
    type: "line"
    height: 300
    showGrid: true
    interactive: true

metric_display:
  overrides:
    format: "percentage"
    size: "lg"
```

**Interactions**:
- Close modal: Return to main correlation view with `effects.semantic_transitions.modal`
- Chart interaction: Hover for time-series correlation values
- Export data: Download correlation data as CSV

## State Management
**States with Token References**:
```yaml
loading:
  spinner_color: "colors.semantic.primary"
  overlay_background: "colors.semantic.surface"
  
high_correlation_warning:
  background: "colors.semantic.status.warning"
  text: "colors.semantic.text.primary"
  border: "colors.semantic.border.strong"
  
low_correlation_success:
  background: "colors.semantic.profit"
  text: "colors.semantic.text.inverse"
  
correlation_thresholds:
  high_risk: "colors.semantic.loss"      # >0.7 correlation
  medium_risk: "colors.semantic.warning" # 0.3-0.7 correlation  
  low_risk: "colors.semantic.profit"     # <0.3 correlation
```

## Shared Components Usage Summary
- main_navigation: Page navigation
- page_header: Screen title and context
- correlation_matrix: Primary correlation visualization (2 instances)
- data_card: Analysis summary panels (4 instances)
- metric_display: Key correlation metrics (6 instances)
- modal: Strategy pair detail overlay
- performance_chart: Time-series correlation chart
- button: Action buttons (3 instances)
- loading_spinner: Data loading states

## Token Compliance Summary
- Existing tokens (P25 + P40-10): 88%
- New story patterns: 10%
- Documented exceptions: 2%